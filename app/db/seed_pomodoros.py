from app.db.database import SessionLocal
from app.db.models import Pomodoro, Session
import uuid
from datetime import datetime

db = SessionLocal()

def seed_pomodoros():
    """ê¸°ë³¸ í”„ë¦¬ì…‹ ë½€ëª¨ë„ë¡œ ë° ì„¸ì…˜ ë°ì´í„° ì‚½ì…"""
    try:
        # âœ… ê¸°ë³¸ ë½€ëª¨ë„ë¡œë“¤
        default_pomodoros = [
            {
                "title": "refine",
                "sessions": [
                    { "order": 1, "duration": 25, "goal": "ìƒê°ë‚˜ëŠ” ì•„ì´ë””ì–´ë¥¼ ì œí•œ ì—†ì´ ì­‰ ì ì–´ë³´ê¸°" ,"type_id":1,"name":'ë°œì‚°'},
                    { "order": 2, "duration": 5, "goal": "ë¨¸ë¦¬ë¥¼ ë¹„ìš°ê³  ì ê¹ ì‰¬ê¸°","type_id":14 ,"name":'ë‹¨ê¸°íœ´ì‹'},
                    { "order": 3, "duration": 25, "goal": "ì£¼ë³€ í˜„ìƒì´ë‚˜ ëŒ€ìƒì„ ì£¼ì˜ ê¹Šê²Œ ë³´ê³  ê¸°ë¡í•˜ê¸°","type_id":3 ,"name":'ê´€ì°°'},
                    { "order": 4, "duration": 5, "goal": "ë¨¸ë¦¬ë¥¼ ë¹„ìš°ê³  ì ê¹ ì‰¬ê¸°","type_id":14,"name":'ë‹¨ê¸°íœ´ì‹' },
                    { "order": 5, "duration": 25, "goal": "ê²°ê³¼","type_id":4 ,"name":'ìŠ¤í¬ë¦¬ë‹'},
                    { "order": 6, "duration": 25, "goal": "ë¨¸ë¦¿ì† ìƒê°ì„ ììœ ë¡­ê²Œ í˜ë ¤ë³´ë‚´ê³ , ìµœì†Œí•œì˜ í–‰ë™/í‘œí˜„ìœ¼ë¡œ ê°ê° ìœ ì§€","type_id":15,"name":'ì¥ê¸°íœ´ì‹' },
                ],
            },
            {
                "title": "reverse",
                "sessions": [
                    { "order": 1, "duration": 25,"goal": "ë°œì‚°í•œ ì•„ì´ë””ì–´ ì¤‘ ì¤‘ìš”í•œ ê²ƒë§Œ ê³¨ë¼ êµ¬ì²´í™”í•˜ê¸°", "type_id":2 ,"name":'ìˆ˜ë ´'},
                    { "order": 2, "duration": 5,"goal": "ë¨¸ë¦¬ë¥¼ ë¹„ìš°ê³  ì ê¹ ì‰¬ê¸°", "type_id": 14,"name":'ë‹¨ê¸°íœ´ì‹' },
                    { "order": 3, "duration": 5,"goal": "ì£¼ë³€ í˜„ìƒì´ë‚˜ ëŒ€ìƒì„ ì£¼ì˜ ê¹Šê²Œ ë³´ê³  ê¸°ë¡í•˜ê¸°", "type_id":3 ,"name":'ê´€ì°°'},
                    { "order": 4, "duration": 5,"goal": "ë¨¸ë¦¬ë¥¼ ë¹„ìš°ê³  ì ê¹ ì‰¬ê¸°", "type_id":14,"name":'ë‹¨ê¸°íœ´ì‹' },
                    { "order": 5, "duration": 25,"goal": "ê¸°ì¡´ ì•„ì´ë””ì–´ë¥¼ ë’¤ì§‘ì–´ ìƒˆ ê´€ì ìœ¼ë¡œ ì¬ë°°ì¹˜í•˜ê¸°", "type_id": 6 ,"name":'ë’¤ì§‘ê¸° ì‚¬ê³ '},
                    { "order": 6, "duration": 25,"goal": "ë¨¸ë¦¿ì† ìƒê°ì„ ììœ ë¡­ê²Œ í˜ë ¤ë³´ë‚´ê³ , ìµœì†Œí•œì˜ í–‰ë™/í‘œí˜„ìœ¼ë¡œ ê°ê° ìœ ì§€", "type_id": 15 ,"name":'ì¥ê¸°íœ´ì‹'},
                ],
            },
            {
                "title": "random",
                "sessions": [
                   { "order": 1, "duration": 25,"goal": "ìƒê°ë‚˜ëŠ” ì•„ì´ë””ì–´ë¥¼ ì œí•œ ì—†ì´ ì­‰ ì ì–´ë³´ê¸°", "type_id": 1 ,"name":'ë°œì‚°'},
                    { "order": 2, "duration": 5,"goal": "ë¨¸ë¦¬ë¥¼ ë¹„ìš°ê³  ì ê¹ ì‰¬ê¸°", "type_id": 14,"name":'ë‹¨ê¸°íœ´ì‹' },
                    { "order": 3, "duration": 25,"goal": "ë¬´ì‘ìœ„ ì•„ì´ë””ì–´ì— í˜„ì‹¤ì ì¸ ê·œì¹™ ì ìš©í•´ ë³´ê¸°", "type_id": 7 ,"name":'ì œì•½ ë„ì…'},
                    { "order": 4, "duration": 5, "goal": "ë¨¸ë¦¬ë¥¼ ë¹„ìš°ê³  ì ê¹ ì‰¬ê¸°", "type_id": 14,"name":'ë‹¨ê¸°íœ´ì‹' },
                    { "order": 5,"duration": 25,"goal": "ìƒê°ë‚˜ëŠ” ì•„ì´ë””ì–´ë¥¼ ì œí•œ ì—†ì´ ì­‰ ì ì–´ë³´ê¸°", "type_id":1 ,"name":'ë°œì‚°'},
                    { "order": 6,"duration": 25,"goal": "ë¨¸ë¦¿ì† ìƒê°ì„ ììœ ë¡­ê²Œ í˜ë ¤ë³´ë‚´ê³ , ìµœì†Œí•œì˜ í–‰ë™/í‘œí˜„ìœ¼ë¡œ ê°ê° ìœ ì§€", "type_id": 15,"name":'ì¥ê¸°íœ´ì‹' },
                ],
            },
            {
                "title": "emotion",
                "sessions": [
                    { "order": 1, "duration": 25,"goal": "ìƒê°ë‚˜ëŠ” ì•„ì´ë””ì–´ë¥¼ ì œí•œ ì—†ì´ ì­‰ ì ì–´ë³´ê¸°", "type_id": 1,"name":'ë°œì‚°' },
                    { "order": 2, "duration": 5,"goal": "ë¨¸ë¦¬ë¥¼ ë¹„ìš°ê³  ì ê¹ ì‰¬ê¸°", "type_id": 14,"name":'ë‹¨ê¸°íœ´ì‹' },
                    { "order": 3, "duration": 25,"goal": "ì§€ê¸ˆ ëŠë¼ëŠ” ê°ì •ì„ ê¸€ì´ë‚˜ ê·¸ë¦¼ìœ¼ë¡œ ê¸°ë¡í•˜ê¸°", "type_id": 8,"name":'ê°ì • ê¸°ë¡' },
                    { "order": 4, "duration": 5, "goal": "ë¨¸ë¦¬ë¥¼ ë¹„ìš°ê³  ì ê¹ ì‰¬ê¸°", "type_id": 14 ,"name":'ë‹¨ê¸°íœ´ì‹'},
                    { "order": 5, "duration": 25,"goal": "ìƒê°ë‚˜ëŠ” ì•„ì´ë””ì–´ë¥¼ ì œí•œ ì—†ì´ ì­‰ ì ì–´ë³´ê¸°", "type_id": 1,"name":'ë°œì‚°' },
                    { "order": 6, "duration": 25, "goal": "ë¨¸ë¦¿ì† ìƒê°ì„ ììœ ë¡­ê²Œ í˜ë ¤ë³´ë‚´ê³ , ìµœì†Œí•œì˜ í–‰ë™/í‘œí˜„ìœ¼ë¡œ ê°ê° ìœ ì§€", "type_id": 15,"name":'ì¥ê¸°íœ´ì‹' },
                ],
            },
            {
                "title": "explore",
                "sessions": [
                    { "order": 1, "duration": 25,"goal": "ìƒê°ë‚˜ëŠ” ì•„ì´ë””ì–´ë¥¼ ì œí•œ ì—†ì´ ì­‰ ì ì–´ë³´ê¸°", "type_id":1,"name":'ë°œì‚°' },
                    { "order": 2, "duration": 5,"goal": "ë¨¸ë¦¬ë¥¼ ë¹„ìš°ê³  ì ê¹ ì‰¬ê¸°", "type_id": 14,"name":'ë‹¨ê¸°íœ´ì‹' },
                    { "order": 3, "duration": 25,"goal": "ì•„ì´ë””ì–´ì— í‚¤ì›Œë“œë‚˜ ì¹´í…Œê³ ë¦¬ë¥¼ ë¶™ì—¬ ì •ë¦¬í•˜ê¸°", "type_id": 9 ,"name":'ì•„ì´ë””ì–´ íƒœê¹…'},
                    { "order": 4, "duration": 5,"goal": "ë¨¸ë¦¬ë¥¼ ë¹„ìš°ê³  ì ê¹ ì‰¬ê¸°", "type_id": 14,"name":'ë‹¨ê¸°íœ´ì‹' },
                    { "order": 5, "duration": 25,"goal": "ìƒê°ë‚˜ëŠ” ì•„ì´ë””ì–´ë¥¼ ì œí•œ ì—†ì´ ì­‰ ì ì–´ë³´ê¸°", "type_id": 1,"name":'ë°œì‚°' },
                    { "order": 6, "duration": 25, "goal": "ë¨¸ë¦¿ì† ìƒê°ì„ ììœ ë¡­ê²Œ í˜ë ¤ë³´ë‚´ê³ , ìµœì†Œí•œì˜ í–‰ë™/í‘œí˜„ìœ¼ë¡œ ê°ê° ìœ ì§€", "type_id": 15,"name":'ì¥ê¸°íœ´ì‹' },
                ],
            },
            {
                "title": "story",
                "sessions": [
                    { "order": 1, "duration": 25,"goal": "ë°œì‚°í•œ ì•„ì´ë””ì–´ ì¤‘ ì¤‘ìš”í•œ ê²ƒë§Œ ê³¨ë¼ êµ¬ì²´í™”í•˜ê¸°", "type_id": 2 ,"name":'ìˆ˜ë ´'},
                    { "order": 2, "duration": 5,"goal": "ë¨¸ë¦¬ë¥¼ ë¹„ìš°ê³  ì ê¹ ì‰¬ê¸°", "type_id": 14,"name":'ë‹¨ê¸°íœ´ì‹' },
                    { "order": 3, "duration": 25, "goal": "ì „ì²´ íë¦„ì„ ë‹¨ê³„ë³„ë¡œ ì„¤ê³„í•˜ê³  ì—°ê²° í™•ì¸í•˜ê¸°", "type_id": 10,"name":'êµ¬ì¡°í™”' },
                    { "order": 4, "duration": 5,  "goal": "ë¨¸ë¦¬ë¥¼ ë¹„ìš°ê³  ì ê¹ ì‰¬ê¸°", "type_id": 14 ,"name":'ë‹¨ê¸°íœ´ì‹'},
                    { "order": 5, "duration": 25, "goal": "ë°œì‚°í•œ ì•„ì´ë””ì–´ ì¤‘ ì¤‘ìš”í•œ ê²ƒë§Œ ê³¨ë¼ êµ¬ì²´í™”í•˜ê¸°", "type_id": 2,"name":'ìˆ˜ë ´' },
                    { "order": 6, "duration": 25, "goal": "ë¨¸ë¦¿ì† ìƒê°ì„ ììœ ë¡­ê²Œ í˜ë ¤ë³´ë‚´ê³ , ìµœì†Œí•œì˜ í–‰ë™/í‘œí˜„ìœ¼ë¡œ ê°ê° ìœ ì§€", "type_id": 15,"name":'ì¥ê¸°íœ´ì‹' },
                ],
            },
            {
                "title": "echo",
                "sessions": [
                    { "order": 1, "duration": 25, "goal": "ì£¼ë³€ í˜„ìƒì´ë‚˜ ëŒ€ìƒì„ ì£¼ì˜ ê¹Šê²Œ ë³´ê³  ê¸°ë¡í•˜ê¸°", "type_id": 3,"name":'ê´€ì°°' },
                    { "order": 2, "duration": 5, "goal": "ë¨¸ë¦¬ë¥¼ ë¹„ìš°ê³  ì ê¹ ì‰¬ê¸°", "type_id":14,"name":'ë‹¨ê¸°íœ´ì‹' },
                    { "order": 3, "duration": 25, "goal": "ì‘ì—… ì¤‘ ëŠë‚€ ê°ì •ì„ ê¸°ë¡í•˜ê³  íŒ¨í„´ í™•ì¸í•˜ê¸°", "type_id": 11,"name":'ë°˜ì‘ ë¶„ì„'},
                    { "order": 4, "duration": 5, "goal": "ë¨¸ë¦¬ë¥¼ ë¹„ìš°ê³  ì ê¹ ì‰¬ê¸°", "type_id": 14,"name":'ë‹¨ê¸°íœ´ì‹' },
                    { "order": 5, "duration": 25, "goal": "ì£¼ë³€ í˜„ìƒì´ë‚˜ ëŒ€ìƒì„ ì£¼ì˜ ê¹Šê²Œ ë³´ê³  ê¸°ë¡í•˜ê¸°", "type_id": 3 ,"name":'ê´€ì°°'},
                    { "order": 6, "duration": 25, "goal": "ë¨¸ë¦¿ì† ìƒê°ì„ ììœ ë¡­ê²Œ í˜ë ¤ë³´ë‚´ê³ , ìµœì†Œí•œì˜ í–‰ë™/í‘œí˜„ìœ¼ë¡œ ê°ê° ìœ ì§€", "type_id": 15,"name":'ì¥ê¸°íœ´ì‹' },
                ],
            },
            {
                "title": "escape",
                "sessions": [
                    { "order": 1, "duration": 25, "goal": "ìƒê°ë‚˜ëŠ” ì•„ì´ë””ì–´ë¥¼ ì œí•œ ì—†ì´ ì­‰ ì ì–´ë³´ê¸°", "type_id":1,"name":'ë°œì‚°' },
                    { "order": 2, "duration": 5, "goal": "ë¨¸ë¦¬ë¥¼ ë¹„ìš°ê³  ì ê¹ ì‰¬ê¸°", "type_id": 14 ,"name":'ë‹¨ê¸°íœ´ì‹'},
                    { "order": 3,"duration": 25, "goal": "ê¸°ì¡´ ê·œì¹™ì„ ê³¼ê°íˆ ë²—ì–´ë‚˜ ìƒˆ ë°©ì‹ ì‹œë„í•˜ê¸°", "type_id": 12,"name":'ê·œì¹™ íƒˆì°©' },
                    { "order": 4, "duration": 5, "goal": "ë¨¸ë¦¬ë¥¼ ë¹„ìš°ê³  ì ê¹ ì‰¬ê¸°", "type_id": 14,"name":'ë‹¨ê¸°íœ´ì‹' },
                    { "order": 5, "duration": 25, "goal": "ìƒê°ë‚˜ëŠ” ì•„ì´ë””ì–´ë¥¼ ì œí•œ ì—†ì´ ì­‰ ì ì–´ë³´ê¸°", "type_id":1,"name":'ë°œì‚°' },
                    { "order": 6, "duration": 25, "goal": "ë¨¸ë¦¿ì† ìƒê°ì„ ììœ ë¡­ê²Œ í˜ë ¤ë³´ë‚´ê³ , ìµœì†Œí•œì˜ í–‰ë™/í‘œí˜„ìœ¼ë¡œ ê°ê° ìœ ì§€", "type_id": 15,"name":'ì¥ê¸°íœ´ì‹' },
                ],
            },
            {
                "title": "repeat",
                "sessions": [
                    { "order": 1,"duration": 25, "goal": "ìƒê°ë‚˜ëŠ” ì•„ì´ë””ì–´ë¥¼ ì œí•œ ì—†ì´ ì­‰ ì ì–´ë³´ê¸°", "type_id":1,"name":'ë°œì‚°' },
                    { "order": 2, "duration": 5, "goal": "ë¨¸ë¦¬ë¥¼ ë¹„ìš°ê³  ì ê¹ ì‰¬ê¸°", "type_id": 14 ,"name":'ë‹¨ê¸°íœ´ì‹'},
                    { "order": 3, "duration": 25, "goal": "ë°œì‚°í•œ ì•„ì´ë””ì–´ ì¤‘ ì¤‘ìš”í•œ ê²ƒë§Œ ê³¨ë¼ êµ¬ì²´í™”í•˜ê¸°", "type_id": 2,"name":'ìˆ˜ë ´' },
                    { "order": 4, "duration": 5,"goal": "ë¨¸ë¦¬ë¥¼ ë¹„ìš°ê³  ì ê¹ ì‰¬ê¸°", "type_id": 14,"name":'ë‹¨ê¸°íœ´ì‹' },
                    { "order": 5, "duration": 25, "goal": "ì•„ì´ë””ì–´ë¥¼ ì—¬ëŸ¬ ë°©ì‹ìœ¼ë¡œ ë³€í˜•í•˜ë©° ë°œì „ì‹œí‚¤ê¸°", "type_id": 13,"name":'ë³€í˜•' },
                    { "order": 6, "duration": 25, "goal": "ë¨¸ë¦¿ì† ìƒê°ì„ ììœ ë¡­ê²Œ í˜ë ¤ë³´ë‚´ê³ , ìµœì†Œí•œì˜ í–‰ë™/í‘œí˜„ìœ¼ë¡œ ê°ê° ìœ ì§€", "type_id": 15,"name":'ì¥ê¸°íœ´ì‹' },
                ],
            },
            {
                "title": "empty",
                "sessions": [
                    { "order": 1, "duration": 25, "goal": "ìƒê°ë‚˜ëŠ” ì•„ì´ë””ì–´ë¥¼ ì œí•œ ì—†ì´ ì­‰ ì ì–´ë³´ê¸°", "type_id":1,"name":'ë°œì‚°' },
                    { "order": 2, "duration": 5, "goal": "ë¨¸ë¦¬ë¥¼ ë¹„ìš°ê³  ì ê¹ ì‰¬ê¸°", "type_id": 14,"name":'ë‹¨ê¸°íœ´ì‹' },
                    { "order": 3, "duration": 5, "goal": "ì£¼ë³€ í˜„ìƒì´ë‚˜ ëŒ€ìƒì„ ì£¼ì˜ ê¹Šê²Œ ë³´ê³  ê¸°ë¡í•˜ê¸°", "type_id": 3,"name":'ê´€ì°°' },
                    { "order": 4, "duration": 5, "goal": "ë¨¸ë¦¬ë¥¼ ë¹„ìš°ê³  ì ê¹ ì‰¬ê¸°", "type_id": 14 ,"name":'ë‹¨ê¸°íœ´ì‹'},
                    { "order": 5, "duration": 25, "goal": "ìƒê°ë‚˜ëŠ” ì•„ì´ë””ì–´ë¥¼ ì œí•œ ì—†ì´ ì­‰ ì ì–´ë³´ê¸°", "type_id":1,"name":'ë°œì‚°' },
                    { "order": 6, "duration": 25, "goal": "ë¨¸ë¦¿ì† ìƒê°ì„ ììœ ë¡­ê²Œ í˜ë ¤ë³´ë‚´ê³ , ìµœì†Œí•œì˜ í–‰ë™/í‘œí˜„ìœ¼ë¡œ ê°ê° ìœ ì§€", "type_id": 15,"name":'ì¥ê¸°íœ´ì‹' },
                ],
            }
        ]

        for p in default_pomodoros:
            # ì¤‘ë³µ ì²´í¬ (title ê¸°ì¤€)
            existing = db.query(Pomodoro).filter_by(title=p["title"]).first()
            if existing:
                continue

            pomodoro = Pomodoro(
                id=uuid.uuid4(),
                title=p["title"],
                user_id=None,  # í”„ë¦¬ì…‹ì€ null
            )
            db.add(pomodoro)
            db.commit()
            db.refresh(pomodoro)

            # í•˜ìœ„ ì„¸ì…˜ ì¶”ê°€
            for s in p["sessions"]:
                session = Session(
                    pomodoro_id=pomodoro.id,
                    goal=s["goal"],
                    duration=s["duration"],
                    order=s["order"],
                    name=s["name"],
                    type_id=s["type_id"], 
                )
                db.add(session)

            db.commit()

        print("âœ… ê¸°ë³¸ í”„ë¦¬ì…‹ ë½€ëª¨ë„ë¡œ ë° ì„¸ì…˜ ë°ì´í„° ì‚½ì… ì™„ë£Œ!")

    except Exception as e:
        db.rollback()
        print(f"ğŸš¨ ì˜¤ë¥˜ ë°œìƒ: {e}")

    finally:
        db.close()
